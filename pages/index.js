import Head from "next/head";
import Image from "next/image";
import styles from "../styles/Home.module.css";

const defaultEndpoint = "https://dog.ceo/api/breeds/image/random/9";

export async function getServerSideProps() {
  const res = await fetch(defaultEndpoint);
  const { message: dogs } = await res.json();
  
  // const res = await fetch(`https://dog.ceo/api/breeds/${breed}/random/3`);
  // const breed = req.query['breed'].toString()

  return {
    props: { dogs },
  };
}

export default function Home({ dogs }) {

  const RenderDogData = (data) => {
    return data.map((dog, idx) => {
      const url = new URL(dog);
      const path = url.pathname;
      const str = path.split('/')
      console.log('path ===', str);
      return (
        <div>
          <Image
                id={idx}
                src={dog}
                alt={str[2] || idx}
                width={240}
                height={240}
          />
          <h5>{str[2]}</h5>
        </div>
      )
    })
  }
  console.log('data', dogs)
  return (
    <div className={styles.container}>
      <Head>
        <title>Dog Breed App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main>

        {/* {dogs.map((dog, idx) => (
            (
              <Image
                id={idx}
                src={dog}
                alt={idx}
                width={240}
                height={240}
              />
            ))
        )} */}

        {RenderDogData(dogs)}

        {/* <div className="grid">
          {data.map((img) => (
            <img
              className="breed"
              src={img}
              alt="{breed}"
              width={240}
              height={240}
            />
          ))} */}
        {/* </div> */}
      </main>
    </div>
  );
}
